<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>kkBeep</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="kkBeep">
<meta property="og:url" content="http://kakyoism.github.io/index.html">
<meta property="og:site_name" content="kkBeep">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="kkBeep">
  
    <link rel="alternate" href="/atom.xml" title="kkBeep" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">kkBeep</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">互动音频用户</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://kakyoism.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-quick-auditioning-music-transitions" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/29/quick-auditioning-music-transitions/" class="article-date">
  <time datetime="2017-10-29T10:23:07.000Z" itemprop="datePublished">2017-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/GameAudio/">GameAudio</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/29/quick-auditioning-music-transitions/">快速试听 Wwise 互动音乐的过渡</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文探讨的所有问题和解决方案都<strong>基于 Wwise 2017.1.x</strong>。不对后续版本负责。</p>
<h2 id="起因：听一下过渡好难"><a href="#起因：听一下过渡好难" class="headerlink" title="起因：听一下过渡好难"></a>起因：听一下过渡好难</h2><p>利用 Wwise 的互动音乐功能可以用小段音乐编组搭建出动态和互动的曲式和织体，但搭完了之后你还是得用耳朵试听乐段间的过渡，确保衔接在音乐意义上是无缝的。截至 Wwise 2017.1，不少人在这里遇到了麻烦，见下图：</p>
<!--![](quick-auditioning-music-transitions/mpe.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/mpe.png">
<p>这个例子来自 Wwise 自带的示例工程<code>Sample Project</code>（可以从Wwise Launcher 的<code>SAMPLES</code>页下打开），在 Music Playlist Editor 中，<code>Stealth</code>这个 Music Playlist Container 中有一个 Sequence Continuous 模式的 Music Segment 编组，图中正在试听前两个 Music Segment 间的过渡。这时，由于<code>Stealth</code>采用的过渡规则中，Source 段用了<code>Exit source at Exit Cue</code>这条同步规则，见下图：</p>
<!--![](quick-auditioning-music-transitions/transition-exit-cue.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/transition-exit-cue.png">
<p>Exit Cue 一般靠近曲子尾声，所以你必须把<code>Stealth_Seg_01</code>从头听到 Exit Cue 处才能开始试听和<code>Stealth_Seg_02</code>间的过渡，当曲子很长，这样就很浪费时间；而更浪费时间的情况是：当要听的过渡在一个很长的连续列表的中间靠后时，即便同步点是 Next Bar 这样近距离的，每次你还都得从最顶上听起。如下图：</p>
<!--![](quick-auditioning-music-transitions/mpe-mid-seg.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/mpe-mid-seg.png">
<p>要听<code>Seg 02b (B)</code>到下一段的过渡，你每次都得从<code>Seg 01a (A)</code>听起。上图里还比较仁慈，每个段落都只循环了一次，万一有些会循环有限次，万一播着中间接了个电话，… 你懂的。</p>
<p>于是你又下意识地跑到 Music Segment Editor 界面中想对着波形迅速定位到过渡点附近听，结果发现一次又只能试听一个 Segment，见下图：</p>
<!--![](quick-auditioning-music-transitions/mse.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/mse.png">
<p>所以还是快不起来。</p>
<p>在别的情况下，也会有类似问题：</p>
<ul>
<li>确认单个 Music Segment 的循环无缝时。</li>
<li>试听 Music Switch Container 下的状态切换时。</li>
</ul>
<p>需要强调的是，这个问题有多痛和设计有关，只有几个小节长的短小 Music Segment 可能几乎感觉不到。</p>
<p>面对这些情况，<strong>你的期望大概是这么三条</strong>：</p>
<ol>
<li>能从播放列表中直接挑出任何一对 Music Segment 来听过渡，不管它们在什么地方。</li>
<li>能定位到过渡点附近开始听。</li>
<li>能试听单曲循环的首尾衔接。</li>
</ol>
<p>换句话说：如今主流媒体播放器能做到的一些事情。</p>
<!--![](quick-auditioning-music-transitions/media-player.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/media-player.png">
<p>上图中，如果你想听<code>Say</code>和<code>Architect</code>这两首曲子间的过渡（假设有的话），那么只需要鼠标双击<code>Say</code>这首，然后用底部进度条定位到尾部收听即可。如果要测自循环，则只需要把循环模式调到单曲循环就行了（注：Wwise 中由于有同步点的问题，常规的进度条还不够）。</p>
<p>相比之下，我们发现：<strong>Wwise 虽然提供了搭建非线性音乐结构的一整套工具，但其 UI 的预览功能不支持线性媒体播放器中的定点播放体验。</strong> 当然，反过来大多数线性媒体播放器也不支持 Wwise 提供的众多非线性播放功能。</p>
<p>在 Wwise 在 UI 上做出改进之前，我们暂时还得面对这个问题。</p>
<p>好消息是，“解决方法“（Hack）还是有的，虽然都不完美！<br>我们来看看到 Wwise 2017.1 版本为止，目前已知的三种技巧。我把它们按从直观到抽象排了序。</p>
<h2 id="技巧一：手动拼接法"><a href="#技巧一：手动拼接法" class="headerlink" title="技巧一：手动拼接法"></a>技巧一：手动拼接法</h2><p>看到标题你估计已经有点失望了。没错，这个方法很简单粗暴：通过复制粘贴把想要一起听过渡的几个 Clip 放到 Music Segment Editor 的多轨界面上，手动确保各个 Clip 的 Exit Cue 和 Entry Cue 彼此对齐，最后通过光标直接定位到过渡点附近收听播放。如果要测某一轨的无缝循环，那就把该轨上的内容复制一遍紧贴在自己的尾巴上。</p>
<p>实际操作中有个麻烦：在 Music Segment Editor 下对齐来自两个 Music Segment 的 Clip 时，只有一个 Segment 的 Exit Cue 和 Entry Cue 能显示出来，另一个的则看不到。所以你可能要另想办法来对齐同步点，比如用 Clip handle 临时裁剪掉看不到 cue 的 Music Segment 的 Pre-Entry 或者 Post-Exit 部分，不然很难肉眼对齐。</p>
<p>这个方法的优点是：</p>
<ol>
<li>概念简单，接近 DAW 里面的操作习惯。</li>
<li>能通过交互来精确定位到过渡点附近。</li>
<li>可以试听任何 Music Segment 甚至单个 Clip 的组合。</li>
</ol>
<p>但缺点很明显：</p>
<ol>
<li>用来拼接 Music Segment 的临时操作会改动 Music Segment，污染了设计本身。事后还得清理现场。虽然可以创建专门的“测试段落”，但就要维护这个多轨测试对象，并不轻松。</li>
<li>很难快速测试多轨 Music Segment 间的过渡。上面说的 Clip handle 操作对各轨可能都要做一遍。</li>
<li>手动操作繁琐，对齐容易出错。</li>
</ol>
<p>这个方法大约只适合粗略测单轨循环的情况。如果非要走这条路，倒还不如直接在 DAW 里面对素材做这些工作来得简单。</p>
<h2 id="技巧二：快进播放法"><a href="#技巧二：快进播放法" class="headerlink" title="技巧二：快进播放法"></a>技巧二：快进播放法</h2><p>这个是 <a href="https://www.audiokinetic.com/courses/wwise201/?source=wwise201&amp;id=configuring_multi_group_playlists_setting_randomized_loop_counts" target="_blank" rel="external">Wwise 201 认证教程</a> 中推荐的方法，海内外的一些设计师都有这样用的，见下图：</p>
<!--![](quick-auditioning-music-transitions/playbackspeed.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/playbackspeed.png">
<p>将父级容器的播放速度调大，那么播放时过渡涉及的 Music Segment 就能快进到过渡点附近。这时候如果想精听，则可以降回原速，除非你告诉我专业人士的耳朵都是 4 倍速的！</p>
<p>这个方法的优点是：</p>
<ol>
<li>概念简单。</li>
<li>对设计的污染少。只动一个播放速度参数，用后还是很容易调回来的，因为默认值一般都是 1。</li>
</ol>
<p>但是缺点仍然很明显：</p>
<ol>
<li>在 Music Playlist Editor 中，依然无法直接收听任意一对 Music Segment 的过渡，只能从头顺序播放。</li>
<li>这是一种渐进操作，无法一步定位到过渡点附近。</li>
<li>操作上对反射神经有一定要求 …</li>
</ol>
<h2 id="技巧三：Seek-法"><a href="#技巧三：Seek-法" class="headerlink" title="技巧三：Seek 法"></a>技巧三：Seek 法</h2><p>这个技巧是海外设计师 Aaron Brown 分享的。基本原理是立足于 Event 及其 Seek（即寻址跳转）这个 Action。跟前两种方法相比，它更能满足本文开始分析的三条期望，但实际操作要绕点路。</p>
<p>Aaron Brown 的原始分享可以在 Wwise 的非官方 Facebook 群<code>Wwise Wizards &amp; Witches</code>中找到，但是他只给了粗略的示意图，如下图所示：</p>
<!--![](quick-auditioning-music-transitions/wwise-tips-audition-transitions.jpg)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/wwise-tips-audition-transitions.jpg">
<p>但我实操后发现在 Wwise 2017.1 中上面的方法并不能凑效，要修改一些做法。下面详细讲解一下。</p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>这个方法是希望避免肉眼定位和等待，实现一键定位到音乐的过渡点附近，按照原速收听过渡。</p>
<p>Wwise 的 Event 中有 Seek 这个 Action 可以定位到播放文件中的指定位置。前两种方法其实也做了这个定位，只不过是用肉眼和手工操作来确保的：开始试听过渡的播放点必须要在同步点之前。而针对这点，Seek Action 只需设好跳转位置的数值就可以。并且，它还有服务于互动音乐的<a href="https://www2.audiokinetic.com/library/edge/?source=Help&amp;id=event_actions_list#bp1307910" target="_blank" rel="external">一条诱人的特性</a>：</p>
<ul>
<li>Seek Action 的 Seek Percent（按百分比跳转）模式下，跳转是相对于 Entry Cue 和 Exit Cue 进行的。</li>
</ul>
<p>打个比方，不管这些 Cue 设定在 Music Segment 的什么位置，如果我们把跳转设在 99% 处（即 Seek Percent 为 99%），它也绝对不会超出 Exit Cue 而误入 Post-Exit 段；对于单曲循环的情况，跳转百分比位置是相对循环区间来算的。有了这个条件，我们就可以放心定义跳转点来一键空降到过渡点附近了。</p>
<p>不过 Seek Action 还有<a href="https://www2.audiokinetic.com/library/edge/?source=Help&amp;id=event_actions_list#seek_seekall_notes_and_restrictions" target="_blank" rel="external">一条重要的限制</a>：</p>
<ul>
<li>Music Playlist Container 和 Motion 对象不支持 Seek。</li>
</ul>
<p>而 Music Segment 不能控制过渡，只能依赖其父级容器，所以在 Event 中实现过渡的唯一希望就是 Music Switch Container 了。你大概明白了吧？<strong>我们要使用 State 切换来模拟所有的过渡情况，在切换状态之前执行 Seek 动作来直接跳转到过渡点之前的邻近位置，就能达到“直接”播放过渡段的目的。</strong></p>
<p>State 切换要模拟的情况包括:</p>
<ol>
<li>工程自身互动音乐设计中的状态过渡。</li>
<li>Music Playlist Container 里面的相邻 Music Segment 间过渡。</li>
<li>Music Segment 单曲循环的首尾衔接。</li>
</ol>
<p>看起来好像很复杂，但其实只需要把要做过渡的 Music Segment 提取出来，分别关联一个 State，指派给一个测试用的 Music Switch Container 就可以了。</p>
<p>下面我们通过一个实例来说明做法。</p>
<h3 id="做法示例"><a href="#做法示例" class="headerlink" title="做法示例"></a>做法示例</h3><p>我们还是以 Wwise 安装包自带的<code>Sample Project</code>为例来说明 Seek 法的具体操作。简单起见，我们就挑选下图中选中的两个 Music Segment 来举例：</p>
<!--![](quick-auditioning-music-transitions/sample-segments.png)
-->
<img src="/2017/10/29/quick-auditioning-music-transitions/sample-segments.png">
<p>这两个 Segment 也是<code>Stealth</code>这个 Music Playlist Container 中顺序播放的相邻对象（见本文第一张图），采用的过渡同步点为 Exit Cue。</p>
<p><strong>首先，创建一个专用的 Music Switch Container，把<code>Steath_Seg_01</code>和<code>Steath_Seg_02</code>复制到它下面。</strong>见下图：</p>
<!--![](quick-auditioning-music-transitions/sample-dup-msc.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/sample-dup-msc.png">
<p>创建新的 Music Switch Container 是有原因的：在指定 Music Switch Container 的状态路径的时候，路径对应播放对象只能是该 Music Switch Container 的直接子对象，也就是说之前位于<code>Stealth</code>下面的对象如果不挪出来就无法直接关联到 State 上面去；而如果直接复制到原 Music Switch Container 下面，就又会污染设计。所以比较好的做法是直接创建一个新的 Music Switch Container。</p>
<p>这个专用容器的过渡规则一般只需要用默认的<code>Any to Any</code>规则就可以，但要注意默认会播放源段的 Post-Exit 和目标段的 Pre-Entry，不启用淡变。当然，你完全可以按需要来定制整条规则。这里我们重点强调 Exit Cue 的情况。</p>
<p><strong>接着，创建一个新的 State Group，然后为两个 Music Segment 各创建一个 State。</strong>见下图：</p>
<!--![](quick-auditioning-music-transitions/sample-states.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/sample-states.png">
<p><strong>下一步，回到测试专用的 Music Switch Container，设置好状态路径，让上面的 State 和 Music Segment 一一对应。</strong>见下图：</p>
<!--![](quick-auditioning-music-transitions/sample-paths.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/sample-paths.png">
<p><strong>最后，我们创建测试事件</strong>。里面依序包含如下 Action：</p>
<!--![](quick-auditioning-music-transitions/sample-event.png)-->
<img src="/2017/10/29/quick-auditioning-music-transitions/sample-event.png">
<ul>
<li>我们让第一个 Set State Action（状态初始化）比 Play Action 稍早一点执行，确保在播放之前状态已经初始化成源状态，播放源 Segment。这里我们把 Play Action 的 Delay 设为<code>0.01</code>， Set State 的 Delay 为 <code>0</code>。</li>
<li>Seek Action 也比播放略提前，Seek 模式为<code>Seek Percent</code>，位置为<code>90%</code>。你可以视需要修改这个位置。注意：Aaron Brown 在 Wwise 2016.2 中采用 Seek All 这个 Action，Scope 设为 Global，但经测试发现在 Wwise 2017.1 中这个做法无效，要使用 Seek 才行。</li>
<li>后一个 Set State Action 也就是状态切换的动作比播放稍晚一点，确保不会覆盖第一个 Set State 操作，导致源 Segment 没能播放起来。所以这里的 Delay 设为<code>0.02</code>。</li>
</ul>
<p>现在测试一下这个 Event，看是不是能一步到位试听过渡？</p>
<p>如果要试听一个 Music Segment 单曲循环的首尾衔接，则可以把问题转化为“从这个段落过渡到它自己的副本”，唯一需要改变的就是要复制源 Music Segment，把它作为目标段落即可。</p>
<p>你可能会问：“我就用同一个 Music Segment，给它关联两个不同的 State 不行吗？”然而 Wwise 中，基于 State/Switch 过渡时前后必须为两个不同的对象，音乐引擎才会启动过渡行为。所以必须给原 Music Segment 做一个副本，才能通过切换 State 来测试自循环过渡。</p>
<p>为了简单，示例中我们就地在工程已有的 Work Unit 中创建试听用的临时对象和其它元素。这样做还是污染了现有设计的，因为 Work Unit 对应 XML 文件，是 Wwise 工程的设计内容实体。所以比较好的做法是创建测试专用的 Work Unit，这样就不会污染，且很容易一键删除所有测试元素。注意，测试对象只要保证不打到 SoundBank 里就不会影响游戏的实际性能。</p>
<h3 id="进一步讨论"><a href="#进一步讨论" class="headerlink" title="进一步讨论"></a>进一步讨论</h3><p>为了试听一个小小的过渡，Seek 法看起来并不直观，需要好几步操作，这是它最明显的缺点。但是我们可以看到 Seek 法有独特的优势：</p>
<ol>
<li>它可以满足我们的三条期望。</li>
<li>它不需要人工肉眼对位，也不依赖反应。这点别的工具很难做到。</li>
<li>设好的 Event、Music Switch Container 和 State 可以作为一套可复用的测试框架保留下来，用同一套框架甚至同一个事件测试各种过渡，只用反复改变事件 Action 列表中的 两个 State 就好。</li>
<li>整个流程可以通过 Wwise Authoring API（WAAPI）自动化脚本来加速。</li>
</ol>
<p>除以上三种方法之外，还可以用 WAAPI 做后端来写一个简单的媒体播放器播放列表界面来达到传统的体验。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本文针对很多人提到的“听一下过渡好难”的痛点，总结了一下在不编程或自己写第三方 UI 的情况下，现有能加速试听过渡的方案，希望能给大家一点帮助，权当抛砖引玉，欢迎大家指正和探讨其它可能的技巧和方案。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kakyoism.github.io/2017/10/29/quick-auditioning-music-transitions/" data-id="cj9fsjwsf000g456m6297qjod" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wwise-interactivemusic/">wwise, interactivemusic</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-GDC17-Audio-Spatial-Audio-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/13/GDC17-Audio-Spatial-Audio-2/" class="article-date">
  <time datetime="2017-03-13T09:55:57.000Z" itemprop="datePublished">2017-03-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/GameAudio/">GameAudio</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/13/GDC17-Audio-Spatial-Audio-2/">GDC17 音频见闻 - 空间音频 Spatial Audio（2）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Wwise-2017-1-的空间音频新功能"><a href="#Wwise-2017-1-的空间音频新功能" class="headerlink" title="Wwise 2017.1 的空间音频新功能"></a>Wwise 2017.1 的空间音频新功能</h2><img src="/2017/03/13/GDC17-Audio-Spatial-Audio-2/sa-wwise-wal.jpg" title="全新 Spatial Audio 测试地图：Wwise Audio Lab">
<p>上篇说到微软的 Project Triton 未来的方向恰好与 Wwise 2017.1 的一些新功能不谋而合，简单地说，Wwise</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kakyoism.github.io/2017/03/13/GDC17-Audio-Spatial-Audio-2/" data-id="cj9fsjwot0000456msvtel9jm" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/conference-gdc17-reverb-obstruction-occlusion-spatialaudio/">conference, gdc17, reverb, obstruction-occlusion, spatialaudio</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-GDC17-音频见闻（1）-空间音频-Spatial-Audio" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/" class="article-date">
  <time datetime="2017-03-13T05:50:33.000Z" itemprop="datePublished">2017-03-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/GameAudio/">GameAudio</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/">GDC17 音频见闻 - 空间音频 Spatial Audio（1）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="《Gears-of-War-4》中的环境声学预处理技术"><a href="#《Gears-of-War-4》中的环境声学预处理技术" class="headerlink" title="《Gears of War 4》中的环境声学预处理技术"></a>《Gears of War 4》中的环境声学预处理技术</h2><p>继 Binaural 和 Ambisonics 之后，今年 GDC 上的空间音频热门关键字多了<em>混响</em>（Reverberation）、<em>声障和声笼</em>（Obstruction &amp; Occlusion）这些环境声学概念，标志着对沉浸音频体验发起的又一次冲锋。这些游戏音频界的旧瓶里最受瞩目的新酒之一当数微软研究院和《战争机器4》（GoW4）开发组的 <a href="http://schedule.gdconf.com/session/gears-of-war-4-project-triton-pre-computed-environmental-wave-acoustics" target="_blank" rel="external">Project Triton</a>，即通过预先演算声波传播物理参数来辅助人工设计的环境声学效果方案。本次的演讲实际上是微软已启动六年之久系列研究的首次产品化成果。演讲幻灯片<a href="http://www.nikunjr.com/Projects/Triton/Triton-GDC2017.pptx" target="_blank" rel="external">已放出</a>。以下尝试稍加总结。</p>
<h3 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h3><p>这乍一看很学术范的技术主要是为了解决游戏环境声学设计中的一大痛点：传统设计方法依赖在游戏地图中手工标注或绘制声学区域，再挂接音频效果器来实现室内混响和声障／声笼效果；音频中间件如 Wwise 的效果器控制参数一般是够用的，但在游戏中手工标注的工作量巨大且容易出错，实际开发工期紧，很难打磨调优。</p>
<p>不巧，玩家极易通过生活经验察觉这类设计错误，后果严重，参见《刺客信条：大革命》中曾出现的<a href="http://forums.ubi.com/showthread.php/973716-AC-Unity-Sound-Bug-Forums" target="_blank" rel="external">全局 bug</a>。音频设计界早就希望能像物理渲染界一样自动化这个过程，为创意设计赢得时间。</p>
<p>演讲中放出的<em>最终</em>解决方案：</p>
<img src="/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/sa-triton-game-integration.jpg" title="Triton 系统整合示意图">
<ul>
<li>离线预处理：在游戏地图中自动选取采样位置，对各个位置上的发声体-听者结对（emitter-listener pair）根据几何数据自动做 3D 声波传播模拟并生成原始声学数据库；</li>
<li>解析：从原始声学数据自动提炼出一组感知参数值：直达波能量、反射波能量、反射波衰减率（wetness）和混响衰减率；</li>
<li>接入音频中间件：运行时通过查询数据库获取感知参数值，用来控制 Wwise 中的声障／声笼滤波器和辅助总线上的混响效果器，产生实时互动的声学效果。</li>
</ul>
<p>用这种方法，设计师不再需要手动标注环境声学区域，可以专注于艺术效果设计，即通过感知参数来控制音频效果输出。结果不但错误少，且游戏中的实时性能也达到甚至优于项目初始要求。</p>
<p>一些细节：</p>
<ul>
<li>声障值和声笼值分别用初始能量（直达声比例）和反射能量来代表；</li>
<li>区分室外和室内情况，方法是通过在室外设置理想边界，并测量从玩家位置发声后能抵达这条边界的能量占总能量的比例来推算<em>室内-室外比</em>，以此来做到平滑过渡；</li>
<li>原始声学数据计算用 100 台机器需要约 4 小时计算时间，初始数据为 50 TB，做解析后降为 100 MB。</li>
</ul>
<h3 id="经历"><a href="#经历" class="headerlink" title="经历"></a>经历</h3><p>很多学术报告大概也就到此为止了，让一部分听众感觉高山仰止，另一部分不知所云。然而这次两位主讲人–微软研究院的 Nikunj Raghuvanshi 和 Coalition 工作室的 John Tennant –继续披露了研发和产品化的详细经过，以机器人领域的<a href="http://baike.baidu.com/item/恐怖谷理论" target="_blank" rel="external"><em>恐怖谷</em></a>现象为纲，讲述了从真实到艺术真实的探索（微信游戏音频群里尾巴老师语），体现了对基础研究和产品化过程深刻的理解，是演讲中我个人最喜欢的部分。</p>
<img src="/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/sa-triton-uncanny-valley.jpg">
<p>从 2011 年的 V1.0 到 2014 年的 V2.0 直到最终版，项目经历了标准的恐怖谷历程：</p>
<ol>
<li>V1.0 中初尝预处理甜头后，发现一些问题亟待解决，比如区分室内外和消除混响效果中的浑浊；</li>
<li>于是寄希望于自动化和仿真路线，火力全开，将模型复杂化：从 FDN 混响换成卷积混响，声学数据因此变成冲激响应，在增加室外效果器组分支的同时还增加了对早期反射和后期混响的区分，导致要控制 12 个混响单元；</li>
<li>不幸跌入恐怖谷，为了自救而后退一步，着重解决艺术真实问题，最后简化了模型，按时保质完成了产品化。</li>
</ol>
<p>一些真实和艺术真实的折衷处理：</p>
<ul>
<li>冲激响应路线很难控制质量：录音和测量人员不同，因此高度依赖配准，为后期调试带来困难，终弃；</li>
<li>混响效果受输入声音动态范围影响，将输入的<em>真实</em>动态范围做了艺术限制之后，清晰度得到提升；</li>
<li>与传统影视建立的艺术效果标准相比，物理计算中得出的直达声能量以及衰减时间，结合游戏具体玩法后，会出现不合心理期望的情况，终弃。</li>
</ul>
<p>有意思的是，上面的道理很多其实是马后炮：是在主动作出简化混响模型的决定后从实践中领悟到的，又一次说明奥卡姆剃刀原则的普适性。</p>
<h3 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h3><p>Triton 项目的未来计划包括在预处理模型中加入：</p>
<ul>
<li>直达分量方向性、早期反射、户外回声；</li>
<li>动态几何结构，比如活动的门窗和物理毁坏。</li>
</ul>
<p>巧的是，Triton 和 Wwise 不谋而合，这几条正是 GDC17 上 Wwise 2017.1 版本展出的新 Spatial Audio 功能的一部分，请看下篇。</p>
<h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ul>
<li>演讲幻灯片: <a href="http://www.nikunjr.com/Projects/Triton/Triton-GDC2017.pptx" target="_blank" rel="external">‘Gears of War 4’, Project Triton: Pre-Computed Environmental Wave Acoustics</a></li>
<li>Engadget 文章：<a href="https://www.engadget.com/2016/10/25/gears-of-war-4-microsoft-research-triton/" target="_blank" rel="external">Microsoft Research helped ‘Gears of War 4’ sound so good</a></li>
<li>Triton V1.0 论文：<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/10/6.pdf" target="_blank" rel="external">Raghuvanshi, et. al., SIGGRAPH 2010, “Precomputed wave simulation for real-time sound propagation of dynamic sources in complex scenes”
</a></li>
<li>Triton V2.0 论文：<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2016/07/ParametricWaveField.pdf" target="_blank" rel="external">Raghuvanshi &amp; Snyder, SIGGRAPH 2014, “Parametric wave field coding for precomputed sound propagation”
</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kakyoism.github.io/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/" data-id="cj9fsjwpg0004456myjh6du12" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/conference-gdc17-reverb-obstruction-occlusion-spatialaudio/">conference, gdc17, reverb, obstruction-occlusion, spatialaudio</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-migs-2016" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/15/migs-2016/" class="article-date">
  <time datetime="2017-01-15T11:52:13.000Z" itemprop="datePublished">2017-01-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/GameAudio/">GameAudio</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/15/migs-2016/">补记 MIGS 2016 上的演讲见闻</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近一次的<a href="http://www.migs16.com/en/" target="_blank" rel="external">蒙特利尔国际游戏峰会 MIGS 2016</a>过去一阵子了，只有3岁的 MIGS 在规模上无法跟 GDC 这样的老字号相提并论，不过每年还是有些有用的技术演讲，在此追记一下自己去过那几场的要点，主要是音频专场。
        
          <p class="article-more-link">
            <a href="/2017/01/15/migs-2016/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://kakyoism.github.io/2017/01/15/migs-2016/" data-id="cj9fsjwsc000f456mso2zok1t" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/conference/">conference</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/machinelearning/">machinelearning</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/proceduralaudio/">proceduralaudio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reverb/">reverb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wwise/">wwise</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Hello-Hexo-你好-Hexo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/25/Hello-Hexo-你好-Hexo/" class="article-date">
  <time datetime="2016-12-25T05:54:17.000Z" itemprop="datePublished">2016-12-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Writing/">Writing</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/25/Hello-Hexo-你好-Hexo/">第一天</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前玩公众号，但发现在引用外链和离线写作方面有限制。很多时候我期待的是自由外链引用、离线为主、一键发布、迭代迁移方便的博客流程。</p>
<p>GitHub 的静态站点系统 <a href="https://pages.github.com" target="_blank" rel="external">GitHub Pages</a> 支持按照软件开发流程来管理博客，通过纯文本标记格式比如 <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="external">Markdown</a> 写作存为本地文件，再一键发布到远程。</p>
<p>所以来 GitHub 试试。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://kakyoism.github.io/2016/12/25/Hello-Hexo-你好-Hexo/" data-id="cj9fsjwp30001456m0qao9dvt" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/github/">github</a></li></ul>

    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/10/29/quick-auditioning-music-transitions/">快速试听 Wwise 互动音乐的过渡</a>
          </li>
        
          <li>
            <a href="/2017/03/13/GDC17-Audio-Spatial-Audio-2/">GDC17 音频见闻 - 空间音频 Spatial Audio（2）</a>
          </li>
        
          <li>
            <a href="/2017/03/13/GDC17-音频见闻（1）-空间音频-Spatial-Audio/">GDC17 音频见闻 - 空间音频 Spatial Audio（1）</a>
          </li>
        
          <li>
            <a href="/2017/01/15/migs-2016/">补记 MIGS 2016 上的演讲见闻</a>
          </li>
        
          <li>
            <a href="/2016/12/25/Hello-Hexo-你好-Hexo/">第一天</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/GameAudio/">GameAudio</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Writing/">Writing</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/conference/">conference</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/conference-gdc17-reverb-obstruction-occlusion-spatialaudio/">conference, gdc17, reverb, obstruction-occlusion, spatialaudio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/machinelearning/">machinelearning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proceduralaudio/">proceduralaudio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reverb/">reverb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wwise/">wwise</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wwise-interactivemusic/">wwise, interactivemusic</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/conference/" style="font-size: 10px;">conference</a> <a href="/tags/conference-gdc17-reverb-obstruction-occlusion-spatialaudio/" style="font-size: 20px;">conference, gdc17, reverb, obstruction-occlusion, spatialaudio</a> <a href="/tags/github/" style="font-size: 10px;">github</a> <a href="/tags/machinelearning/" style="font-size: 10px;">machinelearning</a> <a href="/tags/proceduralaudio/" style="font-size: 10px;">proceduralaudio</a> <a href="/tags/reverb/" style="font-size: 10px;">reverb</a> <a href="/tags/wwise/" style="font-size: 10px;">wwise</a> <a href="/tags/wwise-interactivemusic/" style="font-size: 10px;">wwise, interactivemusic</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 北南<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>